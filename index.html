<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<title>Plantafel Dachdeckerei Frey</title>
<style>
body { font-family: Arial, sans-serif; background:#f4f6f8; margin:0; padding:20px; }
h1 { background:#1e5ed8; color:#fff; padding:10px 15px; }
section { background:#fff; padding:15px; margin-bottom:15px; border-radius:6px; }
input { padding:6px; }
button { padding:6px 10px; margin-left:5px; }
.list span {
  display:inline-block; padding:5px 8px; margin:4px;
  background:#e0e7ff; border-radius:4px; cursor:grab;
}
.months { display:grid; grid-template-columns:repeat(4,1fr); gap:10px; }
.month {
  min-height:80px; border:1px dashed #aaa; padding:5px;
  background:#fafafa;
}
.month h4 { margin:0 0 5px 0; font-size:14px; }
.trash {
  border:2px dashed red; padding:10px; text-align:center;
  color:red; margin-top:15px;
}
</style>
</head>

<body>

<h1>Plantafel Dachdeckerei Frey</h1>

<section>
<h3>Fahrzeuge</h3>
<input id="vehicleInput" placeholder="Fahrzeug" />
<button onclick="addVehicle()">+</button>
<div id="vehicleList" class="list"></div>
</section>

<section>
<h3>Mitarbeiter</h3>
<input id="employeeInput" placeholder="Name" />
<button onclick="addEmployee()">+</button>
<div id="employeeList" class="list"></div>
</section>

<section>
<h3>Projekt-Parkplatz (12 Monate)</h3>
<input id="projectInput" placeholder="Projektname" />
<button onclick="addProject()">Projekt +</button>

<div class="months" id="months"></div>

<div class="trash" ondragover="event.preventDefault()" ondrop="deleteProject(event)">
❌ Entfernen – hierher ziehen
</div>
</section>

<script>
/* ================= STATE ================= */
const STORAGE_KEY = "plantafel_state";

let state = {
  vehicles: [],
  employees: [],
  projects: [] // {id,name,month}
};

/* ================= STORAGE ================= */
function saveState() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
}
function loadState() {
  const s = localStorage.getItem(STORAGE_KEY);
  if (s) state = JSON.parse(s);
}

/* ================= INIT ================= */
const monthNames = ["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"];

function initMonths() {
  const m = document.getElementById("months");
  m.innerHTML = "";
  monthNames.forEach((name,idx)=>{
    const d = document.createElement("div");
    d.className = "month";
    d.dataset.month = idx;
    d.ondragover = e => e.preventDefault();
    d.ondrop = e => dropProject(e, idx);
    d.innerHTML = `<h4>${name}</h4>`;
    m.appendChild(d);
  });
}

/* ================= RENDER ================= */
function render() {
  document.getElementById("vehicleList").innerHTML =
    state.vehicles.map(v=>`<span>${v}</span>`).join("");

  document.getElementById("employeeList").innerHTML =
    state.employees.map(e=>`<span>${e}</span>`).join("");

  initMonths();
  state.projects.forEach(p=>{
    const el = document.createElement("span");
    el.textContent = p.name;
    el.draggable = true;
    el.ondragstart = e => e.dataTransfer.setData("id", p.id);
    document.querySelector(`.month[data-month="${p.month}"]`).appendChild(el);
  });
}

/* ================= ACTIONS ================= */
function addVehicle() {
  const v = vehicleInput.value.trim();
  if (!v) return;
  state.vehicles.push(v);
  vehicleInput.value="";
  saveState(); render();
}

function addEmployee() {
  const e = employeeInput.value.trim();
  if (!e) return;
  state.employees.push(e);
  employeeInput.value="";
  saveState(); render();
}

function addProject() {
  const p = projectInput.value.trim();
  if (!p) return;
  state.projects.push({id:crypto.randomUUID(), name:p, month:0});
  projectInput.value="";
  saveState(); render();
}

function dropProject(e, month) {
  const id = e.dataTransfer.getData("id");
  const p = state.projects.find(x=>x.id===id);
  if (p) p.month = month;
  saveState(); render();
}

function deleteProject(e) {
  const id = e.dataTransfer.getData("id");
  state.projects = state.projects.filter(p=>p.id!==id);
  saveState(); render();
}

/* ================= START ================= */
loadState();
render();
</script>

</body>
</html>
